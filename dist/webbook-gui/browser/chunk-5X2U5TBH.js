import{a as pe}from"./chunk-CRKCYOSI.js";import{a as Z,b as ee,c as te,d as ne,e as ie,g as x,i as ae,j as re,k as oe,l as le,m as se,n as D,p as ce}from"./chunk-BEKV6SGG.js";import{b as Q,g as W,j as X,k as Y}from"./chunk-XLBWKML2.js";import{a as de}from"./chunk-HWLAH6MP.js";import{i as N,j as H,k as $}from"./chunk-4OMTBMHX.js";import{$a as h,Ea as z,Fa as R,Oa as a,Pa as y,Sa as U,Xa as d,Ya as P,Z as A,ab as v,bb as I,ca as C,cb as w,da as S,db as F,ea as k,eb as r,fa as b,fb as s,gb as m,hb as V,ib as G,jb as E,lb as f,mb as p,nb as q,ob as L,pb as c,qb as J,rb as u,wb as M,xb as K,yb as B}from"./chunk-56BPKO74.js";function _e(t,o){if(t&1){let e=E();r(0,"span")(1,"span",9),f("click",function(){C(e);let n=p().$implicit,l=p();return S(l.goToPage(n))}),c(2),s()()}if(t&2){let e=p().$implicit,i=p();a(1),P("current-page",i.currentPage===e),a(1),u(" ",e," ")}}function fe(t,o){if(t&1&&(r(0,"span")(1,"span",10),c(2),s()()),t&2){let e=p().$implicit;a(2),J(e)}}function xe(t,o){if(t&1&&(r(0,"span"),h(1,_e,3,3,"span",8)(2,fe,3,1,"span",8),s()),t&2){let e=o.$implicit;a(1),d("ngIf",e!=="..."),a(1),d("ngIf",e==="...")}}var me=(()=>{let o=class o{constructor(){this.totalPages=20,this.currentPage=1,this.pageChange=new U}get visiblePages(){let i=[];for(let n=1;n<=this.totalPages;n++)n===1||n===this.totalPages||n>=this.currentPage-2&&n<=this.currentPage+2?i.push(n):i[i.length-1]!=="..."&&i.push("...");return i}goToPage(i){i!=="..."&&i!==this.currentPage&&this.pageChange.emit(i)}};o.\u0275fac=function(n){return new(n||o)},o.\u0275cmp=A({type:o,selectors:[["app-pagination"]],inputs:{totalPages:"totalPages",currentPage:"currentPage"},outputs:{pageChange:"pageChange"},standalone:!0,features:[M],decls:11,vars:9,consts:[["aria-label","Pagination Navigation",1,"flex","items-center","justify-center","my-6","text-while"],[1,"flex-1","flex","items-center","justify-center"],[1,"relative","z-0","inline-flex","shadow-sm","rounded-md","items-center"],[3,"click"],[1,"relative","inline-flex","cursor-pointer","px-2","py-2","-ml-px","text-sm","font-medium","text-inhert","rounded-r-md","leading-5"],[1,"fa-solid","fa-angle-left"],[4,"ngFor","ngForOf"],[1,"fa-solid","fa-angle-right"],[4,"ngIf"],[1,"relative","inline-flex","items-center","px-3","py-2","-ml-px","text-sm","font-medium","cursor-pointer","leading-5",3,"click"],[1,"relative","inline-flex","items-center","px-3","py-2","-ml-px","text-sm","font-medium","text-gray-700","cursor-pointer","leading-5"]],template:function(n,l){n&1&&(r(0,"nav",0)(1,"div",1)(2,"div")(3,"span",2)(4,"span",3),f("click",function(){return l.currentPage===1||l.goToPage(l.currentPage-1)}),r(5,"span",4),m(6,"i",5),s()(),h(7,xe,3,2,"span",6),r(8,"span",3),f("click",function(){return l.currentPage===l.totalPages||l.goToPage(l.currentPage+1)}),r(9,"span",4),m(10,"i",7),s()()()()()()),n&2&&(a(4),P("disabled",l.currentPage===1),a(1),P("disabled",l.currentPage===1),a(2),d("ngForOf",l.visiblePages),a(1),P("disabled",l.currentPage===l.totalPages),a(1),P("disabled",l.currentPage===l.totalPages))},dependencies:[$,N,H],styles:[".current-page[_ngcontent-%COMP%], .disabled[_ngcontent-%COMP%]{cursor:not-allowed;opacity:.5}"]});let t=o;return t})();function ve(t,o){if(t&1&&(r(0,"div",20),m(1,"input",21),r(2,"label",22),m(3,"span",23),c(4),s()()),t&2){let e=o.$implicit,i=o.index,n=p();a(1),d("id","st-"+(i+1))("formControl",n.getStatusControl(i)),a(1),d("for","st-"+(i+1)),a(2),u(" ",n.getStatusText(e)," ")}}function Ce(t,o){if(t&1&&(r(0,"div",20),m(1,"input",24),c(2,"\xA0 "),r(3,"label",22),c(4),s()()),t&2){let e=o.$implicit,i=o.$index,n=p();a(1),L("id","tl",e.id,""),d("checked",e.id===0)("formControl",n.getGenreControl(i))("value",e.name),a(2),L("for","tl",e.id,""),a(1),u(" ",e.name," ")}}function Se(t,o){t&1&&c(0,"T\u1EA5t c\u1EA3")}function ye(t,o){if(t&1&&c(0),t&2){let e=p().$implicit;u("> ",e,"")}}function Pe(t,o){if(t&1&&(r(0,"div",20),m(1,"input",25),c(2,"\xA0 "),r(3,"label",22),h(4,Se,1,0)(5,ye,1,1),s()()),t&2){let e=o.$implicit,i=o.index,n=p();a(1),L("id","c-",i+1,""),d("formControl",n.getChapLengthControl(i))("value",e+1)("checked",e===0),a(2),L("for","c-",i+1,""),a(1),v(4,e===0?4:5)}}function Ee(t,o){t&1&&(r(0,"div",26)(1,"div",27)(2,"span",28),c(3,"Loading..."),s()()())}function Te(t,o){if(t&1&&c(0),t&2){let e=p(2);u(" Th\u1EC3 lo\u1EA1i: ",e.genre==null?null:e.genre.name," ")}}function ke(t,o){if(t&1&&c(0),t&2){let e=p(2);u(" T\u1EEB t\xECm ki\u1EBFm: ",e.bookParam," ")}}function be(t,o){t&1&&c(0," C\xF2n ti\u1EBFp ")}function Ie(t,o){t&1&&c(0," Ho\xE0n th\xE0nh ")}function we(t,o){t&1&&c(0," T\u1EA1m ng\u01B0ng ")}function Fe(t,o){if(t&1&&(r(0,"a",54),c(1),s()),t&2){let e=p().$implicit;a(1),u(" ",e.chapterLast.chapterIndex," ch\u01B0\u01A1ng ")}}function Le(t,o){t&1&&(r(0,"a",54),c(1,"0 ch\u01B0\u01A1ng"),s())}var j=t=>["/truyen",t];function Be(t,o){if(t&1&&(r(0,"div",34)(1,"div",35)(2,"a",36),m(3,"img",37),s()(),r(4,"div",38)(5,"div",39)(6,"a",40),c(7),s()(),m(8,"div",41),r(9,"div",42)(10,"div",43)(11,"div",39),k(),r(12,"svg",44),m(13,"path",45),s(),b(),r(14,"a",46)(15,"span",47),c(16),s()()(),r(17,"div")(18,"span",48),h(19,be,1,0)(20,Ie,1,0)(21,we,1,0),s()()(),r(22,"div",43)(23,"div",39),k(),r(24,"svg",44),m(25,"path",49),s(),b(),r(26,"a",50)(27,"span",51),c(28),s()()(),r(29,"div"),m(30,"i",52),h(31,Fe,2,1,"a",53)(32,Le,2,0),s()()()()()),t&2){let e=o.$implicit,i=p(3);a(2),d("routerLink",B(9,j,e.slug)),a(1),q("src",e.coverImage,R),a(3),d("routerLink",B(11,j,e.slug)),a(1),u(" ",e.title,""),a(1),d("innerHTML",e.description,z),a(8),u(" ",e.authorName," "),a(3),v(19,e.status===0?19:e.status===1?20:21),a(9),u(" ",i.genre==null?null:i.genre.name," "),a(3),v(31,e.chapterLast!==null?31:32)}}function Ae(t,o){if(t&1&&(r(0,"div",32)(1,"div",33),w(2,Be,33,13,"div",55,I),s()()),t&2){let e=p(2);a(2),F(e.genre==null?null:e.genre.bookInGenreDtos)}}function Ve(t,o){t&1&&c(0," C\xF2n ti\u1EBFp ")}function Ge(t,o){t&1&&c(0," Ho\xE0n th\xE0nh ")}function Me(t,o){t&1&&c(0," T\u1EA1m ng\u01B0ng ")}function Ne(t,o){if(t&1&&c(0),t&2){let e=o.$implicit;u(" ",e.name," \xA0 ")}}function He(t,o){if(t&1&&(r(0,"a",54),c(1),s()),t&2){let e=p().$implicit;a(1),u(" ",e.chapterLast.chapterIndex," ch\u01B0\u01A1ng ")}}function $e(t,o){t&1&&(r(0,"a",54),c(1,"0 ch\u01B0\u01A1ng"),s())}function De(t,o){if(t&1&&(r(0,"div",34)(1,"div",35)(2,"a",36),m(3,"img",37),s()(),r(4,"div",38)(5,"div",39)(6,"a",40),c(7),s()(),m(8,"div",41),r(9,"div",42)(10,"div",43)(11,"div",39),k(),r(12,"svg",44),m(13,"path",45),s(),b(),r(14,"a",46)(15,"span",47),c(16),s()()(),r(17,"div")(18,"span",48),h(19,Ve,1,0)(20,Ge,1,0)(21,Me,1,0),s()()(),r(22,"div",43)(23,"div",39),k(),r(24,"svg",44),m(25,"path",49),s(),b(),r(26,"a",50)(27,"span",51),w(28,Ne,1,1,null,null,I),s()()(),r(30,"div"),m(31,"i",52),h(32,He,2,1,"a",53)(33,$e,2,0),s()()()()()),t&2){let e=o.$implicit;a(2),d("routerLink",B(8,j,e.slug)),a(1),q("src",e.coverImage,R),a(3),d("routerLink",B(10,j,e.slug)),a(1),u(" ",e.title,""),a(1),d("innerHTML",e.description,z),a(8),u(" ",e.authorName," "),a(3),v(19,e.status===0?19:e.status===1?20:21),a(9),F(e.genres),a(4),v(32,e.chapterLast!==null?32:33)}}function je(t,o){if(t&1&&(r(0,"div",32)(1,"div",33),w(2,De,34,12,"div",55,I),s()()),t&2){let e=p(2);a(2),F(e.booksTotal.books)}}function Oe(t,o){if(t&1){let e=E();V(0),r(1,"app-pagination",56),f("pageChange",function(n){C(e);let l=p(2);return S(l.handlePageChange(n))}),s(),G()}if(t&2){let e=p(2);a(1),d("totalPages",e.totalPages)("currentPage",e.currentPage)}}function ze(t,o){if(t&1){let e=E();V(0),r(1,"app-pagination",56),f("pageChange",function(n){C(e);let l=p(2);return S(l.handlePageChange(n))}),s(),G()}if(t&2){let e=p(2);a(1),d("totalPages",e.totalPages)("currentPage",e.currentPage)}}function Re(t,o){if(t&1){let e=E();V(0),r(1,"app-pagination",56),f("pageChange",function(n){C(e);let l=p(2);return S(l.submitSearch(n))}),s(),G()}if(t&2){let e=p(2);a(1),d("totalPages",e.totalPages)("currentPage",e.currentPage)}}function qe(t,o){if(t&1&&(r(0,"section",29)(1,"div")(2,"div",3)(3,"h3",4),h(4,Te,1,1)(5,ke,1,1),s()(),h(6,Ae,4,0,"div",30),s(),h(7,je,4,0,"div",30)(8,Oe,2,2,"ng-container",31)(9,ze,2,2,"ng-container",31)(10,Re,2,2,"ng-container",31),s()),t&2){let e=p();a(4),v(4,e.genreParam!==void 0?4:e.bookParam!==void 0||e.keywordParam!==void 0?5:-1),a(2),d("ngIf",e.genreParam!==void 0&&e.genres!==void 0),a(1),d("ngIf",(e.bookParam!==void 0||e.keywordParam!==void 0)&&e.booksTotal!==void 0),a(1),d("ngIf",e.genreParam!==void 0&&e.totalPages>0),a(1),d("ngIf",e.bookParam!==void 0&&e.totalPages>0),a(1),d("ngIf",e.keywordParam!==void 0&&e.totalPages>0)}}var Ue=()=>[0,1,2],st=(()=>{let o=class o{constructor(i,n,l,_,g){this.genreService=i,this.bookService=n,this.route=l,this.router=_,this.titleService=g,this.currentPage=1,this.checkLoadingSpin=!0,this.chapLengthValues=[0,50,100,200,500],this.searchForm=new ie({keyword:new x(""),status:new D([new x(!1),new x(!1),new x(!1)]),genre:new D([]),chapLength:new D([])})}ngOnInit(){if(this.route.queryParams.subscribe(n=>{this.genreParam=n["the-loai"],this.genreValue=parseInt(this.genreParam),this.currentPage=parseInt(n.page),this.bookParam=n["tu-tim-kiem"],this.keywordParam=n["tu-khoa"],isNaN(this.currentPage)&&(this.currentPage=1),n["the-loai"]!==void 0&&(isNaN(this.genreValue)||this.getBooksByGenreId(this.genreValue,this.currentPage)),this.bookParam!==void 0&&(this.titleService.setTitle("Danh S\xE1ch Truy\u1EC7n"),this.getBookByTitle(this.bookParam.trim(),this.currentPage))}),typeof localStorage<"u"&&localStorage.getItem("genres_info")){var i=localStorage.getItem("genres_info");this.genres=JSON.parse(i);let n={id:0,name:"T\u1EA5t c\u1EA3",description:"",bookInGenreDtos:[],totalPages:0};this.genres.unshift(n),this.addGenreRadioButtons(this.genres)}this.addChapLengthRadioButtons(this.chapLengthValues)}getBooksByGenreId(i,n){this.genreService.getBooksByGenreId(i,n).subscribe(l=>{this.genre=l,l&&(this.totalPages=l.totalPages,this.titleService.setTitle(l.name)),this.checkLoadingSpin=!1})}getBookByTitle(i,n){this.bookService.GetBookByTitle(i,n).subscribe(l=>{this.booksTotal=l,this.totalPages=this.booksTotal.totalPages,this.checkLoadingSpin=!1})}handlePageChange(i){this.reLoadPage(),this.currentPage=i,this.router.navigate([],{relativeTo:this.route,queryParams:{page:this.currentPage},queryParamsHandling:"merge"}),this.getBooksByGenreId(this.genreValue,i)}reLoadPage(){this.checkLoadingSpin=!0,window.scrollTo(0,0)}getStatusSelection(){return this.searchForm.get("status").controls.map((n,l)=>n.value?l:-1).filter(n=>n!==-1)}getStatusControl(i){return this.searchForm.get("status").at(i)}getStatusText(i){switch(i){case 0:return"\u0110ang ra";case 1:return"Ho\xE0n th\xE0nh";case 2:return"T\u1EA1m ng\u01B0ng";default:return""}}addGenreRadioButtons(i){let n=this.searchForm.get("genre");i!==void 0&&i.forEach((l,_)=>{let g;l.id===0?g=new x(!0):g=new x(!1),g.valueChanges.subscribe(()=>{g.value&&n.controls.forEach((T,O)=>{O!==_&&T.setValue(!1,{emitEvent:!1})})}),n.push(g)})}getGenreControl(i){return this.searchForm.get("genre").at(i)}getGenreSelectionIndex(){return this.searchForm.get("genre").controls.map((n,l)=>n.value?l:-1).filter(n=>n!==-1)}getGenreSelectionId(){return this.getGenreSelectionIndex().map(l=>this.genres[l].id)[0]}addChapLengthRadioButtons(i){let n=this.searchForm.get("chapLength");i.forEach((l,_)=>{let g;l===0?g=new x(!0):g=new x(!1),g.valueChanges.subscribe(T=>{T&&n.controls.forEach((O,ue)=>{ue!==_&&O.setValue(!1,{emitEvent:!1})})}),n.push(g)})}getChapLengthControl(i){return this.searchForm.get("chapLength").at(i)}getChapLengthSelection(){let i=this.getChapLengthSelectionIndex();return i.length>0?this.chapLengthValues[i[0]]:null}getChapLengthSelectionIndex(){return this.searchForm.get("chapLength").controls.map((n,l)=>n.value?l:-1).filter(n=>n!==-1)}submitSearch(i){let n=this.searchForm.value.keyword.trim(),l=this.getStatusSelection(),_=this.getGenreSelectionId(),g=this.getChapLengthSelection();this.reLoadPage(),this.currentPage=i,this.router.navigate(["/truyen"],{relativeTo:this.route,queryParams:{"tu-khoa":n,"trang-thai":l,"the-loai.":_,"do-dai-chuong":g,page:this.currentPage}}),this.bookService.GetBookSearchAll(n,l,_,g,i).subscribe(T=>{this.booksTotal=T,this.totalPages=this.booksTotal.totalPages,this.checkLoadingSpin=!1})}};o.\u0275fac=function(n){return new(n||o)(y(pe),y(de),y(W),y(X),y(Q))},o.\u0275cmp=A({type:o,selectors:[["app-search"]],standalone:!0,features:[M],decls:35,vars:6,consts:[[1,"max-w-screen-xl","mx-auto"],["flag",""],["id","filter-panel",1,"px-2","py-2"],[1,"box-title","flex","justify-between","items-center"],[1,"uppercase"],[3,"formGroup","submit"],["id","filter-setting",1,"px-4","space-y-3"],[1,"flex","flex-col","md:flex-row"],[1,"text-dec","flex-none","font-bold","w-32","my-2"],["id","status",1,"grow","grid","grid-cols-2","gap-4","sm:grid-cols-4","text-sm"],["class","flex items-center",4,"ngFor","ngForOf"],["id","genre",1,"grow","grid","grid-cols-2","gap-4","sm:grid-cols-4","text-sm","mt-2"],["id","chapLength",1,"grow","grid","grid-cols-2","gap-4","sm:grid-cols-4","text-sm","mt-2"],[1,"flex-none","font-bold","w-32","my-2","text-dec"],[1,"grow"],["id","keyword","name","keyword","formControlName","keyword","placeholder","t\xEAn truy\u1EC7n, t\xE1c gi\u1EA3 ... kh\xF4ng b\u1EAFt bu\u1ED9c","value","",1,"w-full","h-10","px-2","border","border-secondary"],[1,"flex","justify-center"],["type","submit","id","button-filter",1,"my-4","px-5","py-2","text-sm","font-medium","rounded-lg","btn-primary"],["class","d-flex justify-content-center align-items-center","style","height: 26vh;"],["id","filter-result","class"," px-2 py-2 mt-6",4,"ngIf"],[1,"flex","items-center"],["type","checkbox",1,"hidden",3,"id","formControl"],[1,"text-dec","flex","items-center","cursor-pointer",3,"for"],[1,"w-4","h-4","inline-block","mr-2","border","border-secondary"],["type","radio","name","genre",3,"checked","id","formControl","value"],["type","radio","name","chapLength",3,"id","formControl","value","checked"],[1,"d-flex","justify-content-center","align-items-center",2,"height","26vh"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],["id","filter-result",1,"px-2","py-2","mt-6"],["class","box-content",4,"ngIf"],[4,"ngIf"],[1,"box-content"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"flex","space-x-3","py-2","px-3"],[1,"flex-shrink-0"],[1,"text-title","font-semibold",3,"routerLink"],["alt","Ta th\u1EADt s\u1EF1 l\xE0 V\u0103n Sao C\xF4ng","loading","eager",1,"h-32","w-24","shadow-lg","rounded",3,"src"],[1,"grow","space-y-2"],[1,"flex","items-center","space-x-1"],[1,"text-title","font-semibold","hover-title",3,"routerLink"],[1,"text-gray-500","text-sm","text-overflow-multiple-lines","text-dec",3,"innerHTML"],[1,"mt-1","space-y-1"],[1,"flex","justify-between","text-gray-500"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor",1,"h-4","w-4"],["fill-rule","evenodd","d","M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z","clip-rule","evenodd"],["href","https://nhungtruyen.com/tac-gia/toan-chuyen-hong-hoa","target","_blank"],[1,"text-xs","truncate","hover-title","text-dec"],[1,"text-xs","bg-gray-200","py-1","px-2"],["d","M7 3a1 1 0 000 2h6a1 1 0 100-2H7zM4 7a1 1 0 011-1h10a1 1 0 110 2H5a1 1 0 01-1-1zM2 11a2 2 0 012-2h12a2 2 0 012 2v4a2 2 0 01-2 2H4a2 2 0 01-2-2v-4z"],["target","_blank"],[1,"text-xs","truncate","text-dec"],[1,"fa-solid","fa-bars"],["class","text-xs py-1 px-2 text-dec"],[1,"text-xs","py-1","px-2","text-dec"],["class","flex space-x-3 py-2 px-3"],[3,"totalPages","currentPage","pageChange"],["class","flex items-center"]],template:function(n,l){n&1&&(r(0,"div",0,1)(2,"section",2)(3,"div",3)(4,"h3",4)(5,"p"),c(6,"T\xECm Ki\u1EBFm N\xE2ng Cao"),s()()(),r(7,"form",5),f("submit",function(){return l.submitSearch(1)}),r(8,"div",6)(9,"div",7)(10,"div",8),c(11,"T\xECnh tr\u1EA1ng"),s(),r(12,"div",9),h(13,ve,5,4,"div",10),s()(),r(14,"div",7)(15,"div",8),c(16,"Th\u1EC3 lo\u1EA1i"),s(),r(17,"div",11),w(18,Ce,5,6,"div",57,I),s()(),r(20,"div",7)(21,"div",8),c(22,"\u0110\u1ED9 d\xE0i ch\u01B0\u01A1ng"),s(),r(23,"div",12),h(24,Pe,6,6,"div",10),s()(),r(25,"div",7)(26,"div",13),c(27,"T\u1EEB kh\xF3a"),s(),r(28,"div",14),m(29,"input",15),s()(),r(30,"div",16)(31,"button",17),c(32," T\xECm Truy\u1EC7n "),s()()()()(),h(33,Ee,4,0,"div",18)(34,qe,11,6,"section",19),s()),n&2&&(a(7),d("formGroup",l.searchForm),a(6),d("ngForOf",K(5,Ue)),a(5),F(l.genres),a(6),d("ngForOf",l.chapLengthValues),a(9),v(33,l.checkLoadingSpin?33:-1),a(1),d("ngIf",!l.checkLoadingSpin))},dependencies:[$,N,H,Y,me,ce,ae,ee,Z,re,te,ne,oe,le,se]});let t=o;return t})();export{st as SearchComponent};
